{
  "kind": "build_request",
  "title": "Complete responsive video and photo editors with mobile/desktop layouts",
  "projectName": "Ultimate Video & Photo Editor",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-228",
      "text": "Create useMediaQuery custom hook in frontend/src/hooks/useMediaQuery.ts that accepts media query string parameter, uses window.matchMedia API to check initial match status, listens for changes using matchMedia.addListener or addEventListener('change'), updates boolean match state on change, cleans up listener on unmount using removeEventListener, and returns current match status boolean",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ],
        "quotes": [
          "Start building"
        ]
      },
      "acceptanceCriteria": [
        "Hook accepts media query string as parameter (e.g., '(min-width: 1024px)')",
        "Uses window.matchMedia API to check match status",
        "Returns boolean indicating current match status",
        "Updates state on window resize/orientation change",
        "Cleans up event listener on component unmount"
      ]
    },
    {
      "id": "REQ-229",
      "text": "Create responsive VideoEditor component at /editor/video route in frontend/src/pages/VideoEditor.tsx that uses useMediaQuery('(min-width: 1024px)') to detect screen width and conditionally renders MobileVideoEditor component for screens < 1024px or DesktopVideoEditor component for screens >= 1024px, both sharing the same editorStore state, timeline engine, keyframe system, and all 50+ AI tools",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Uses useMediaQuery hook to detect 1024px breakpoint",
        "Renders MobileVideoEditor for mobile screens",
        "Renders DesktopVideoEditor for desktop screens",
        "Both layouts share same editorStore state",
        "Both layouts access same timeline engine and keyframe system",
        "All 50+ AI tools available in both layouts"
      ]
    },
    {
      "id": "REQ-230",
      "text": "Create VideoPlayer component in frontend/src/components/VideoPlayer.tsx that renders HTML5 video element with src prop, implements centered play/pause overlay button with icon, tracks currentTime state via timeupdate event, calls onTimeUpdate callback prop with current time value, calls onPlay and onPause callback props, supports ref forwarding for external control with play/pause/seek/getCurrentTime methods, and applies basic styling (width 100%, rounded-xl, bg-black)",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Renders HTML5 video element with src prop",
        "Displays centered play/pause overlay button",
        "Tracks currentTime via timeupdate event",
        "Calls onTimeUpdate callback with time value",
        "Supports ref forwarding with control methods",
        "Applies styling: width 100%, rounded-xl, bg-black"
      ]
    },
    {
      "id": "REQ-231",
      "text": "Implement MobileVideoEditor component in frontend/src/components/MobileVideoEditor.tsx with CapCut-inspired vertical layout: VideoPlayer component at top (width 100%, aspect ratio 16:9) with play/pause overlay controls and audio support, Timeline component in middle section showing horizontal scrolling clips, touch-optimized Toolbar at bottom with large tap targets (min 48px height) for quick actions (Trim, Split, Text, Stickers, Music, Filters, Effects, AI), all panels using glassmorphism styling (bg-white/10 backdrop-blur-xl rounded-xl), white text with text shadows for visibility, and connected to editorStore for state management",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Vertical layout with VideoPlayer at top",
        "Timeline component with horizontal scrolling",
        "Touch-optimized Toolbar with large tap targets (min 48px)",
        "Quick action buttons: Trim, Split, Text, Stickers, Music, Filters, Effects, AI",
        "Glassmorphism styling: bg-white/10 backdrop-blur-xl rounded-xl",
        "White text with shadows for visibility on glassmorphism",
        "Connected to editorStore for state management"
      ]
    },
    {
      "id": "REQ-232",
      "text": "Implement DesktopVideoEditor component in frontend/src/components/DesktopVideoEditor.tsx with After Effects-inspired horizontal layout: top menu bar (h-12) with File/Edit/Composition/Effects/Render buttons, left preview area (flex-1) using existing Preview component with WebGL/Three.js rendering pipeline for GPU-accelerated effects, right side panel (w-80) with stacked Layers and Effects panels showing clip properties, bottom Timeline component (h-64) with keyframe editing capability, all using glassmorphism panels (bg-white/10 backdrop-blur-xl rounded-xl border border-white/20), dark theme (bg-black), and white text with proper contrast",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Horizontal layout with top menu bar (h-12)",
        "Menu buttons: File, Edit, Composition, Effects, Render",
        "Left preview area using existing Preview component with WebGL/Three.js",
        "Right side panel (w-80) with Layers and Effects panels",
        "Bottom Timeline component (h-64) with keyframe editing",
        "Glassmorphism panels: bg-white/10 backdrop-blur-xl rounded-xl border-white/20",
        "Dark theme (bg-black) with white text for visibility"
      ]
    },
    {
      "id": "REQ-233",
      "text": "Update existing Preview component in frontend/src/components/Preview.tsx to detect render mode based on isMobile prop: when isMobile is true, render VideoPlayer component with first active video clip's URL from timeline; when isMobile is false, use existing WebGL/Three.js rendering pipeline with CoreEngine transforms and effects; both modes should display same active clips from timeline at current time position using TimelineEngine.getActiveClips",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Accepts isMobile boolean prop",
        "When isMobile=true, renders VideoPlayer with first active video clip URL",
        "When isMobile=false, uses existing WebGL/Three.js rendering pipeline",
        "Both modes display active clips from timeline at current time",
        "Uses TimelineEngine.getActiveClips to get active clips",
        "Applies CoreEngine transforms when using WebGL mode"
      ]
    },
    {
      "id": "REQ-234",
      "text": "Create photoEditorStore in frontend/src/store/photoEditorStore.ts using Zustand with state properties: imageUrl (string | null), filters object with brightness/contrast/saturation (0-200 range, default 100) and blur (0-10 range, default 0), stickers array with objects containing id, src, x, y, width, height, and actions: setImage(url), updateFilter(filterName, value), addSticker(sticker), updateSticker(id, updates), removeSticker(id), resetFilters()",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Uses Zustand for state management",
        "State includes imageUrl (string | null)",
        "Filters object: brightness, contrast, saturation (0-200, default 100), blur (0-10, default 0)",
        "Stickers array with id, src, x, y, width, height",
        "Actions: setImage, updateFilter, addSticker, updateSticker, removeSticker, resetFilters",
        "Actions properly update state immutably"
      ]
    },
    {
      "id": "REQ-235",
      "text": "Implement PhotoCanvas component in frontend/src/components/PhotoCanvas.tsx that renders HTML5 canvas element, loads image from src prop using Image API, draws image scaled to canvas dimensions (width/height props with defaults 360x640 for mobile, 800x600 for desktop), applies CSS filters from filters prop (brightness(), contrast(), saturate(), blur()), rerenders canvas on filter changes via useEffect, and supports ref forwarding for external canvas access with getImageData/toDataURL methods",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Renders HTML5 canvas element",
        "Loads image from src prop using Image API",
        "Draws image scaled to canvas dimensions",
        "Width/height props with defaults: 360x640 mobile, 800x600 desktop",
        "Applies CSS filters: brightness(), contrast(), saturate(), blur()",
        "Rerenders on filter changes via useEffect",
        "Supports ref forwarding with getImageData/toDataURL methods"
      ]
    },
    {
      "id": "REQ-236",
      "text": "Implement MobilePhotoEditor component in frontend/src/components/MobilePhotoEditor.tsx with vertical layout: PhotoCanvas at top (w-full, h-auto max-h-[60vh]), filter toolbar below with horizontal scroll of filter buttons (Brightness/Contrast/Saturation/Blur) calling photoEditorStore.updateFilter action, file upload input styled as button for image selection, all in glassmorphism panel (bg-white/10 backdrop-blur-xl p-4 rounded-xl), dark background (bg-black), white text with shadows, and connected to photoEditorStore",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Vertical layout with PhotoCanvas at top",
        "PhotoCanvas: w-full, h-auto max-h-[60vh]",
        "Filter toolbar with horizontal scroll",
        "Filter buttons: Brightness, Contrast, Saturation, Blur",
        "Buttons call photoEditorStore.updateFilter",
        "File upload input styled as button",
        "Glassmorphism panel: bg-white/10 backdrop-blur-xl p-4 rounded-xl",
        "Dark background (bg-black), white text with shadows",
        "Connected to photoEditorStore"
      ]
    },
    {
      "id": "REQ-237",
      "text": "Implement DesktopPhotoEditor component in frontend/src/components/DesktopPhotoEditor.tsx with horizontal layout: top menu bar (h-12 bg-gray-900) with File/Edit/Export buttons, center PhotoCanvas (flex-1) with image display, right side panel (w-80) containing FiltersPanel with labeled range sliders (brightness/contrast/saturation 0-200, blur 0-10) and StickersPanel with grid of sticker buttons, all using glassmorphism panels (bg-white/10 backdrop-blur-xl rounded-xl border-white/20) and connected to photoEditorStore",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Horizontal layout with top menu bar (h-12 bg-gray-900)",
        "Menu buttons: File, Edit, Export",
        "Center PhotoCanvas (flex-1) for image display",
        "Right side panel (w-80) with FiltersPanel and StickersPanel",
        "FiltersPanel with range sliders: brightness/contrast/saturation 0-200, blur 0-10",
        "StickersPanel with grid of sticker buttons",
        "Glassmorphism panels: bg-white/10 backdrop-blur-xl rounded-xl border-white/20",
        "Connected to photoEditorStore"
      ]
    },
    {
      "id": "REQ-238",
      "text": "Create FiltersPanel component in frontend/src/components/FiltersPanel.tsx with glassmorphism panel styling (bg-white/10 backdrop-blur-xl p-4 rounded-xl), labeled range sliders for brightness (0-200, default 100), contrast (0-200, default 100), saturation (0-200, default 100), blur (0-10, default 0), each slider calling photoEditorStore.updateFilter on change, reset all button calling resetFilters action, real-time value display next to each slider, and white text with proper contrast",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Glassmorphism styling: bg-white/10 backdrop-blur-xl p-4 rounded-xl",
        "Range sliders: brightness (0-200, default 100), contrast (0-200, default 100), saturation (0-200, default 100), blur (0-10, default 0)",
        "Each slider calls photoEditorStore.updateFilter on change",
        "Reset all button calls resetFilters action",
        "Real-time value display next to each slider",
        "White text with proper contrast for visibility"
      ]
    },
    {
      "id": "REQ-239",
      "text": "Create StickersPanel component in frontend/src/components/StickersPanel.tsx with glassmorphism panel styling (bg-white/10 backdrop-blur-xl p-4 rounded-xl), grid layout (grid-cols-4 gap-2) showing emoji/sticker buttons (üòÄ üòé ‚ù§Ô∏è üî• ‚≠ê üëç üéâ üé®), click handler calling photoEditorStore.addSticker action with sticker data (src as emoji, initial x/y position at center of canvas, default size 64x64), white text, and basic sticker management UI",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Glassmorphism styling: bg-white/10 backdrop-blur-xl p-4 rounded-xl",
        "Grid layout: grid-cols-4 gap-2",
        "Emoji/sticker buttons: üòÄ üòé ‚ù§Ô∏è üî• ‚≠ê üëç üéâ üé®",
        "Click handler calls photoEditorStore.addSticker",
        "Sticker data: src (emoji), x/y (canvas center), size 64x64",
        "White text for visibility",
        "Basic sticker management UI"
      ]
    },
    {
      "id": "REQ-240",
      "text": "Create responsive PhotoEditor component at /editor/photo route in frontend/src/pages/PhotoEditor.tsx that detects screen width using useMediaQuery('(min-width: 1024px)') and conditionally renders MobilePhotoEditor component for screens < 1024px or DesktopPhotoEditor component for screens >= 1024px, both using shared photoEditorStore for state management, includes ThreeBackground component, and includes NavbarDesktop for desktop/MobileBottomNav for mobile",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Uses useMediaQuery('(min-width: 1024px)') to detect screen width",
        "Renders MobilePhotoEditor for screens < 1024px",
        "Renders DesktopPhotoEditor for screens >= 1024px",
        "Both layouts share photoEditorStore",
        "Includes ThreeBackground component",
        "Shows NavbarDesktop on desktop, MobileBottomNav on mobile"
      ]
    },
    {
      "id": "REQ-241",
      "text": "Update Router.tsx to ensure /editor/video route points to VideoEditor component (responsive, not separate mobile/desktop routes) and /editor/photo route points to PhotoEditor component (responsive), both routes wrapped with PageTransition component for consistent 3D navigation effects, preserving all existing AI tool routes (/ai/*) and home page route (/)",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "/editor/video route points to responsive VideoEditor component",
        "/editor/photo route points to responsive PhotoEditor component",
        "Both routes wrapped with PageTransition component",
        "All existing AI tool routes (/ai/*) preserved",
        "Home page route (/) preserved",
        "No separate mobile/desktop routes created"
      ]
    },
    {
      "id": "REQ-242",
      "text": "Update Home page component in frontend/src/pages/Home.tsx to update Photo Edit card navigation from placeholder to /editor/photo route using router.navigate or Link component, keeping all other elements (ThreeBackground, SearchBar, RecentProjects, Create section with Video Edit and Auto Cut cards, AI Tools section, Templates section, NavbarDesktop, MobileBottomNav) exactly as they currently are with no changes to styling, layout, or functionality",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "Photo Edit card navigates to /editor/photo route",
        "All other elements remain unchanged",
        "ThreeBackground, SearchBar, RecentProjects preserved",
        "Create section (Video Edit, Photo Edit, Auto Cut) preserved",
        "AI Tools section preserved",
        "Templates section preserved",
        "NavbarDesktop and MobileBottomNav preserved",
        "No styling, layout, or functionality changes to existing elements"
      ]
    },
    {
      "id": "REQ-243",
      "text": "Ensure all glassmorphism panels across MobileVideoEditor, DesktopVideoEditor, MobilePhotoEditor, and DesktopPhotoEditor use consistent styling: bg-white/10 background color with 10% opacity, backdrop-blur-xl for blur effect, rounded-xl border radius (12px), border border-white/20 for subtle edge definition, appropriate padding (p-4 or p-6), and white text (text-white) with text shadows (shadow-lg) for contrast on glassmorphism backgrounds",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-start-building"
        ]
      },
      "acceptanceCriteria": [
        "All glassmorphism panels use bg-white/10",
        "backdrop-blur-xl applied for blur effect",
        "rounded-xl border radius (12px)",
        "border border-white/20 for subtle edges",
        "Appropriate padding (p-4 or p-6)",
        "White text (text-white) with shadow-lg",
        "Consistent styling across all 4 editor components",
        "High text visibility on glassmorphism backgrounds"
      ]
    }
  ],
  "constraints": [
    "Do not modify backend/main.mo AIJobManager actor - it already has full job processing, caching, scheduling, device profiles, and fallback systems implemented",
    "Do not modify existing AI tool pages in frontend/src/pages/ai/* - all 43 AI tool pages are already implemented",
    "Do not modify existing engine files (CoreEngine, TimelineEngine, KeyframeEngine, EffectEngine, ExportEngine) - they are complete",
    "Do not modify existing components: AIAssistant, AIJobStatus, AIToolCard, HomeOptionCard, TemplateCard, ThreeBackground, NavbarDesktop, MobileBottomNav",
    "Do not modify existing stores: editorStore.ts is complete with tracks, clips, keyframes, and project management",
    "Do not modify existing hooks: useAIJob.ts, useProjectManager.ts, useInternetIdentity.ts, useActor.ts are complete",
    "Do not modify existing services: aiService.ts has all 50+ mock AI functions and API integration points",
    "Do not modify existing type definitions: aiJob.ts and aiTypes.ts have complete type system for all 50+ AI operations",
    "Preserve existing Timeline, Inspector, Toolbar, Preview, ExportModal, ProjectsModal components - only update Preview for isMobile prop",
    "Do not change existing routes for AI tools, Home page, or ComingSoon pages",
    "Maintain existing glassmorphism design system with dark theme (bg-black) and consistent styling",
    "Preserve existing 3D page transitions using PageTransition component with Framer Motion",
    "Do not modify existing data files: homeSections.ts, templates.ts, aiKnowledgeBase.ts are complete"
  ],
  "nonGoals": [
    "Implementing new AI tools beyond the existing 50+",
    "Adding new backend functionality to AIJobManager actor",
    "Creating new state management beyond photoEditorStore",
    "Implementing video/photo export functionality (already exists in ExportEngine)",
    "Adding new animation effects or shaders",
    "Implementing user authentication changes",
    "Adding new project management features",
    "Creating new template systems",
    "Modifying existing AI service provider integrations",
    "Adding new routes beyond /editor/video and /editor/photo",
    "Changing existing home page layout or sections",
    "Implementing real external API calls (mock functions already in place)",
    "Adding new component libraries or dependencies beyond existing stack"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}